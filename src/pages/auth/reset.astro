---
/*
  Página de redirección para recuperación de contraseña usando Supabase + Expo.
  Esta página recibe el token de Supabase desde un enlace HTTPS (clickeable en Gmail),
  y redirige automáticamente a la app móvil usando el esquema "lumi://".
*/
---

<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Redirigiendo…</title>

    <!-- Script de redirección -->
    <script>
      window.onload = () => {
        // Obtener parámetros enviados por Supabase
        const params = new URLSearchParams(window.location.search);
        const type = params.get("type");
        const token = params.get("token_hash");

        // Validación básica
        if (!token || !type) {
          console.error("Faltan parámetros en la URL");
          return;
        }

        // Redirección a la app móvil con esquema "lumi://"
        const appUrl = `lumi://auth/reset?type=${type}&token=${token}`;
        window.location.href = appUrl;
      };
    </script>

    <style>
      body {
        font-family: sans-serif;
        background: #f5f5f5;
        color: #333;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
      }

      .loader {
        width: 48px;
        height: 48px;
        border: 4px solid #dcdcdc;
        border-top-color: #2f7deb;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 12px;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }
    </style>
  </head>

  <body>
    <div class="loader" aria-hidden="true"></div>
    <p>Redirigiendo a la aplicación…</p>
  </body>
</html>
